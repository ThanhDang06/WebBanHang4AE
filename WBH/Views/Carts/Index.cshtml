@model WBH.Models.CartViewModel

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/WBH.cshtml";
}
@section styles {
    <link rel="stylesheet" href="~/Content/Cart.css" />
}
<div class="cart-container">
    <!-- CỘT TRÁI: Thông tin đơn hàng -->
    <div class="order-info" id="checkoutForm">
        <h2>Thông tin đơn hàng</h2>
        <input type="text" id="fullname" placeholder="Họ và tên">
        <input type="text" id="phone" placeholder="Số điện thoại">
        <input type="text" id="address" placeholder="Địa chỉ">

        <select id="city">
            <option value="">Tỉnh/thành phố</option>
        </select>
        <select id="district" disabled>
            <option value="">Quận/huyện</option>
        </select>
        <select id="ward" disabled>
            <option value="">Phường/xã</option>
        </select>

        <textarea id="note" placeholder="Ghi chú thêm"></textarea>

        <h3>Hình thức thanh toán</h3>
        <label class="payment">
            <input type="radio" name="pay" value="COD" checked>
            <span>Thanh toán khi giao hàng (COD)</span>
        </label>
        <label class="payment">
            <input type="radio" name="pay" value="VNPAY">
            <img src="~/Content/Img/AnhVNPAY.jpg" alt="VNPAY" width="40">
            <span>Ví điện tử VNPAY</span>
        </label>
        <label class="payment">
            <input type="radio" name="pay" value="MOMO">
            <img src="~/Content/Img/AnhMOMO.png" alt="MoMo" width="40">
            <span>Thanh toán MoMo</span>
        </label>
    </div>

    <!-- CỘT PHẢI: Giỏ hàng -->
    <div class="cart-summary">
        <h2>Giỏ hàng của bạn</h2>
        <div id="cart-items">
            @foreach (var item in Model.Items)
            {
               <div class="cart-item">
                   <p>@item.Product.ProductName</p>
                   <input type="number" class="quantity-input" min="1"
                          data-cart-id="@item.IDCart"
                          value="@item.Quantity" />
                   <p>Giá: @(item.Product.Price ?? 0):C</p>
               </div>
            }
        </div>

        <div class="voucher-section">
            <h3>Ưu Đãi Dành Cho Bạn</h3>
            <div class="voucher-list">
                @foreach (var voucher in ViewBag.Vouchers as List<WBH.Models.Voucher>)
                {
                    <div class="voucher">
                        <input type="radio" name="voucher" value="@voucher.Code"
                               @(voucher.Code == Model.VoucherCode ? "checked" : "")>
                        <label>
                            <strong>@voucher.Code</strong> -
                            @(voucher.Type == "PERCENT" ? $"Giảm {voucher.Value}%" : $"Giảm {voucher.Value:C}")
                        </label>
                    </div>
                }
            </div>
            <input type="text" id="customVoucher" placeholder="Nhập mã giảm giá">
            <button id="applyVoucher">Áp dụng Voucher</button>
            <button id="removeVoucherBtn" style="display: none">Xóa voucher</button>
        </div>

        <div class="cart-total">
            <p>Tạm tính: <span id="subtotal">@Model.TotalAmount.ToString("N0")₫</span></p>
            <p>Phí vận chuyển: <strong>Miễn phí</strong></p>
            <p>Voucher giảm giá: <span id="voucherDiscount" data-value="@Model.Discount">@Model.Discount.ToString("N0")₫</span></p>
            <hr>
            <p><strong>Tổng: <span id="total">@((Model.TotalAmount - Model.Discount).ToString("N0"))₫</span></strong></p>
            <button id="checkoutBtn" class="checkout btn btn-success">Thanh toán</button>
        </div>
    </div>
</div>
