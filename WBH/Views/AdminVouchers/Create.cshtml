@model WBH.Models.CreateVoucherViewModel


@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/WBH.cshtml";
}
<h2 class="text-center text-primary mb-4">Tạo Voucher</h2>

@using (Html.BeginForm("Create", "AdminVouchers", FormMethod.Post, new { @class = "voucher-form row g-3 needs-validation", novalidate = "novalidate" }))

{
    @Html.AntiForgeryToken()

    <div class="col-md-6">
        @Html.LabelFor(m => m.Type, htmlAttributes: new { @class = "form-label" })
        @Html.DropDownListFor(m => m.Type, new SelectList(new[] { "PERCENT", "AMOUNT" }), "Chọn loại", new { @class = "form-select", required = "required" })
        <div class="invalid-feedback">Vui lòng chọn loại voucher.</div>
    </div>

    <div class="col-md-6">
        @Html.LabelFor(m => m.Value, htmlAttributes: new { @class = "form-label" })
        @Html.TextBoxFor(m => m.Value, new { @class = "form-control", placeholder = "Nhập giá trị giảm giá", required = "required", type = "number", min = "0" })
        <div class="invalid-feedback">Vui lòng nhập giá trị hợp lệ.</div>
    </div>

    <div class="col-md-6">
        @Html.LabelFor(m => m.MinOrderAmount, htmlAttributes: new { @class = "form-label" })
        @Html.TextBoxFor(m => m.MinOrderAmount, new { @class = "form-control", placeholder = "Số tiền tối thiểu", type = "number", min = "0" })
    </div>

    <div class="col-md-6">
        @Html.LabelFor(m => m.RemainingUses, htmlAttributes: new { @class = "form-label" })
        @Html.TextBoxFor(m => m.RemainingUses, new { @class = "form-control", placeholder = "Số lần sử dụng (để trống = không giới hạn)", type = "number", min = "0" })
    </div>

    <div class="col-md-6">
        @Html.LabelFor(m => m.StartDate, htmlAttributes: new { @class = "form-label" })
        @Html.TextBoxFor(m => m.StartDate, "{0:yyyy-MM-ddTHH:mm}", new { @class = "form-control", type = "datetime-local" })
    </div>

    <div class="col-md-6">
        @Html.LabelFor(m => m.EndDate, htmlAttributes: new { @class = "form-label" })
        @Html.TextBoxFor(m => m.EndDate, "{0:yyyy-MM-ddTHH:mm}", new { @class = "form-control", type = "datetime-local" })
    </div>

    <div class="col-12">
        @Html.Label("Chọn khách (để trống = voucher chung)", htmlAttributes: new { @class = "form-label" })
        @Html.DropDownListFor(m => m.IDCus, (SelectList)ViewBag.Customers, "Mọi khách", new { @class = "form-select" })
    </div>

    <div class="col-12 text-center mt-3">
        <button type="submit" class="btn btn-primary btn-lg">Tạo Voucher</button>
    </div>
}

@if (TempData["Success"] != null)
{
    <div class="alert alert-success mt-3 text-center">@TempData["Success"]</div>
}

@section Scripts {
    <script>
        // Bootstrap validation
        (function () {
            'use strict'
            var forms = document.querySelectorAll('.needs-validation')
            Array.prototype.slice.call(forms).forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
        })()
    </script>
}